<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Open Claw Â· å…¨å„€è¡¨æ¿</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@200;300;400;500;700&family=JetBrains+Mono:wght@300;400;600&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FIRSTVILLAGE-INSPIRED DARK MINIMAL SYSTEM
   Deep black Â· Fine lines Â· Maximum space
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root{
  --bg:#0C0C0C;
  --bg2:#111111;
  --bg3:#171717;
  --bg4:#1E1E1E;
  --panel:#111111;
  --border:#222222;
  --border2:#2E2E2E;
  --text:#C0C0BE;
  --dim:#787876;
  --muted:#404040;
  --bright:#E8E8E6;

  /* Amber â€” urgent */
  --urgent-bg:#0F0A04;
  --urgent-bd:#4A2E08;
  --urgent-text:#A87030;

  /* Steel blue â€” blocked */
  --blocked-bg:#060C12;
  --blocked-bd:#1A2E44;
  --blocked-text:#4A7090;

  /* Warm sand â€” remittance */
  --remit-bg:#0C0A06;
  --remit-bd:#3A3020;
  --remit-text:#807060;

  --green:#3A8A58;
  --green-dim:#081408;

  --radius:10px;
  --radius-xs:5px;

  /* firstvillage: very tight header */
  --hdr-h:52px;
  --info-h:26px;
  --strip-h:34px;
}

*{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{
  background:var(--bg);
  color:var(--text);
  font-family:"Noto Sans TC",sans-serif;
  font-weight:300;
  min-height:100vh;
  -webkit-font-smoothing:antialiased;
  letter-spacing:.01em;
}

::-webkit-scrollbar{width:2px;height:2px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border2);border-radius:1px}

/* â”€â”€ HEADER â€” thin, floating â”€â”€ */
header{
  display:flex;align-items:center;justify-content:space-between;
  padding:0 32px;
  height:var(--hdr-h);
  background:rgba(12,12,12,0.90);
  border-bottom:1px solid var(--border);
  position:sticky;top:0;z-index:200;
  backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
  transition:height .35s ease, background .35s ease, box-shadow .35s ease;
}
header.scrolled{
  height:44px;
  background:rgba(12,12,12,0.97);
  box-shadow:0 1px 0 var(--border), 0 8px 32px rgba(0,0,0,.6);
}
.hdr-l{display:flex;align-items:center;gap:14px}
.logo{
  width:28px;height:28px;border-radius:50%;
  overflow:hidden;border:1px solid var(--border2);flex-shrink:0;
  background:var(--bg3);display:flex;align-items:center;justify-content:center;font-size:12px;
}
.logo img{width:100%;height:100%;object-fit:cover;object-position:top center}
.hdr-name{
  font-size:13px;font-weight:500;color:var(--bright);letter-spacing:.08em;
}
.hdr-sub{
  font-size:9px;color:var(--muted);font-weight:300;
  margin-top:1px;letter-spacing:.12em;text-transform:uppercase;
}
.hdr-clock{
  font-family:"JetBrains Mono",monospace;
  font-size:10px;color:var(--dim);text-align:right;line-height:1.9;
  font-weight:300;
}

/* â”€â”€ INFO BAR â”€â”€ */
#info-bar{
  background:var(--bg2);border-bottom:1px solid var(--border);
  padding:0 32px;height:var(--info-h);
  display:flex;align-items:center;justify-content:space-between;
  position:sticky;top:var(--hdr-h);z-index:195;
  font-size:10px;color:var(--dim);white-space:nowrap;overflow:hidden;
  transition:top .35s ease;
}
.ib-weather{display:flex;align-items:center;gap:5px}
.ib-weather b{color:var(--bright);font-weight:400}
.ib-lunar{font-size:9px;letter-spacing:.08em;color:var(--text)}

/* â”€â”€ ALERT STRIP â”€â”€ */
#alert-strip{
  background:var(--panel);border-bottom:1px solid var(--border);
  padding:0 32px;height:var(--strip-h);
  display:flex;align-items:center;
  overflow-x:auto;white-space:nowrap;scrollbar-width:none;
  position:sticky;top:calc(var(--hdr-h) + var(--info-h));z-index:190;
  transition:background .2s,border-color .2s,top .35s ease;
}
#alert-strip::-webkit-scrollbar{display:none}
#alert-strip.live{background:var(--urgent-bg);border-bottom-color:var(--urgent-bd)}
.a-lbl{
  font-size:8px;font-weight:400;letter-spacing:.15em;text-transform:uppercase;
  color:var(--muted);flex-shrink:0;margin-right:16px;
  font-family:"JetBrains Mono",monospace;
}
.a-lbl.hot{color:var(--urgent-text)}
.a-chip{
  display:inline-flex;align-items:center;gap:5px;flex-shrink:0;
  font-size:10px;font-weight:300;
  border:1px solid var(--border2);background:transparent;color:var(--dim);
  padding:3px 10px 3px 7px;border-radius:2px;margin-right:8px;
  transition:opacity .15s;
}
.a-chip:hover{opacity:.7}
.a-chip.u{border-color:var(--urgent-bd);color:var(--urgent-text)}
.a-chip.b{border-color:var(--blocked-bd);color:var(--blocked-text)}
.a-chip.r{border-color:var(--remit-bd);color:var(--remit-text)}
.a-dot{width:4px;height:4px;border-radius:50%;flex-shrink:0}
.a-chip.u .a-dot{background:var(--urgent-text)}
.a-chip.b .a-dot{background:var(--blocked-text)}
.a-chip.r .a-dot{background:var(--remit-text)}
.a-area{font-size:8px;color:inherit;opacity:.5;margin-left:3px}
.a-sep{width:1px;height:10px;background:var(--border);flex-shrink:0;margin:0 6px}
.a-none{font-size:10px;color:var(--muted);font-weight:300;letter-spacing:.05em}

/* â”€â”€ MAIN â€” lots of breathing room â”€â”€ */
main{
  max-width:860px;margin:0 auto;
  padding:48px 32px;
  display:flex;flex-direction:column;gap:52px;
}

/* â”€â”€ SECTION LABEL â€” firstvillage style â”€â”€ */
.sec-lbl{
  font-size:8px;letter-spacing:.2em;font-weight:400;color:var(--muted);
  text-transform:uppercase;margin-bottom:24px;
  display:flex;align-items:center;gap:16px;
  font-family:"JetBrains Mono",monospace;
}
.sec-lbl::after{content:"";flex:1;height:1px;background:var(--border)}

/* â”€â”€ WARN CARDS â”€â”€ */
.warn-grid{display:flex;flex-direction:column;gap:1px;border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.warn-card{
  background:var(--panel);
  padding:20px 24px;
  display:flex;flex-direction:column;gap:10px;
  border-bottom:1px solid var(--border);
  transition:background .15s;position:relative;
}
.warn-card:last-child{border-bottom:none}
.warn-card::before{
  content:"";position:absolute;left:0;top:0;bottom:0;width:2px;
  background:var(--border2);
}
.warn-card:hover{background:var(--bg3)}
.warn-card.urgent::before{background:var(--urgent-text)}
.warn-card.blocked::before{background:var(--blocked-text)}
.warn-card.remittance::before{background:var(--remit-text)}
.warn-card.urgent{background:var(--urgent-bg)}
.warn-card.blocked{background:var(--blocked-bg)}
.warn-card.remittance{background:var(--remit-bg)}
.wc-top{display:flex;align-items:flex-start;justify-content:space-between;gap:16px}
.wc-title{font-size:14px;font-weight:400;color:var(--bright);flex:1;line-height:1.6;letter-spacing:.02em}
.wc-tags{display:flex;gap:4px;flex-shrink:0;align-items:center;flex-wrap:wrap;justify-content:flex-end}
.tag{
  font-size:8px;padding:2px 7px;border-radius:1px;white-space:nowrap;
  font-weight:400;letter-spacing:.08em;text-transform:uppercase;
  border:1px solid var(--border);color:var(--muted);background:transparent;
}
.tag-pri.urgent{border-color:var(--urgent-bd);color:var(--urgent-text)}
.tag-pri.important{border-color:var(--border2);color:var(--dim)}
.tag-status.blocked{border-color:var(--blocked-bd);color:var(--blocked-text)}
.tag-type.remittance{border-color:var(--remit-bd);color:var(--remit-text)}
.wc-meta{
  display:flex;gap:20px;font-size:10px;color:var(--muted);
  font-family:"JetBrains Mono",monospace;font-weight:300;
}
.wc-meta-lbl{font-size:8px;color:var(--muted);margin-right:4px;opacity:.6}
.wc-next{
  font-size:11px;color:var(--dim);padding:6px 0;
  border-top:1px solid var(--border);
  font-weight:300;letter-spacing:.02em;
}
.wc-blocked{
  font-size:11px;color:var(--blocked-text);padding:6px 0;
  border-top:1px solid var(--blocked-bd);font-weight:300;
}
.warn-empty{
  font-size:12px;color:var(--muted);padding:32px;text-align:center;
  border:1px solid var(--border);border-radius:var(--radius);
  letter-spacing:.05em;
}

/* â”€â”€ DAILY BRIEF â”€â”€ */
.brief-wrap{
  background:transparent;
  border:1px solid var(--border);
  border-radius:var(--radius);
  overflow:hidden;
}
.brief-header{
  padding:18px 24px 14px;
  border-bottom:1px solid var(--border);
  display:flex;flex-direction:column;gap:9px;
}
.brief-date{
  font-size:11px;font-weight:400;color:var(--bright);
  letter-spacing:.06em;font-family:"JetBrains Mono",monospace;
}
.brief-luck{display:flex;align-items:center;gap:12px}
.luck-lbl{font-size:8px;letter-spacing:.15em;text-transform:uppercase;
  color:var(--muted);font-family:"JetBrains Mono",monospace;flex-shrink:0}
.luck-item{display:inline-flex;align-items:center;gap:5px;
  font-size:9px;color:var(--dim);letter-spacing:.06em}
.luck-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;
  box-shadow:0 0 4px currentColor}
.brief-body{padding:0}
.brief-block{display:flex;flex-direction:column}
.brief-block-hdr{
  padding:12px 24px 8px;
  font-size:8px;font-weight:400;letter-spacing:.2em;text-transform:uppercase;
  color:var(--muted);font-family:"JetBrains Mono",monospace;
  border-bottom:1px solid var(--border);
}
.brief-line{
  display:flex;align-items:center;gap:12px;
  padding:12px 24px;
  border-bottom:1px solid var(--border);
  font-size:13px;font-weight:300;color:var(--dim);
  transition:background .12s;
}
.brief-line:last-child{border-bottom:none}
.brief-line:hover{background:var(--bg3)}
.brief-time{
  font-size:10px;font-weight:400;color:var(--muted);
  min-width:24px;flex-shrink:0;
  font-family:"JetBrains Mono",monospace;
}
.brief-text{flex:1;color:var(--text);line-height:1.6}
.b-blk{font-size:8px;color:var(--blocked-text);border:1px solid var(--blocked-bd);border-radius:1px;padding:1px 5px;margin-left:6px;letter-spacing:.06em;text-transform:uppercase}
.b-urg{font-size:8px;color:var(--urgent-text);border:1px solid var(--urgent-bd);border-radius:1px;padding:1px 5px;margin-left:6px;letter-spacing:.06em;text-transform:uppercase}
.b-due{font-size:9px;color:var(--muted);margin-left:6px;font-family:"JetBrains Mono",monospace}
.b-area{font-size:9px;color:var(--muted);margin-left:4px}
.sched-status{
  font-size:8px;padding:2px 7px;border-radius:1px;font-weight:400;
  flex-shrink:0;letter-spacing:.06em;text-transform:uppercase;
  border:1px solid;
}
.sched-status.ok{border-color:#1E3C24;color:var(--green)}
.sched-status.warn{border-color:var(--urgent-bd);color:var(--urgent-text)}

/* â”€â”€ ENTRY CARDS â€” firstvillage list style â”€â”€ */
.entry-wrap{
  border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;
}
.entry-card{
  display:flex;align-items:center;gap:0;
  background:var(--panel);
  border-bottom:1px solid var(--border);
  padding:0;text-decoration:none;color:inherit;
  transition:background .15s;
  overflow:hidden;
}
.entry-card:last-child{border-bottom:none}
.entry-card:hover{background:var(--bg3)}
.entry-card.hot .entry-name{color:var(--blocked-text)}
.entry-icon-col{
  width:52px;flex-shrink:0;
  display:flex;align-items:center;justify-content:center;
  padding:18px 0;
  border-right:1px solid var(--border);
  align-self:stretch;
  opacity:.75;
}
.entry-info{flex:1;min-width:0;padding:16px 20px}
.entry-name{font-size:14px;font-weight:400;color:var(--bright);letter-spacing:.02em}
.entry-role{font-size:10px;color:var(--muted);margin-top:3px;letter-spacing:.05em}
.entry-upd{
  font-size:9px;color:var(--muted);margin-top:4px;
  font-family:"JetBrains Mono",monospace;font-weight:300;opacity:.7;
}
.entry-counts{
  display:flex;align-items:center;gap:0;
  padding:0 16px;flex-shrink:0;
}
.cnt-badge{
  display:flex;flex-direction:column;align-items:center;
  padding:10px 14px;border-left:1px solid var(--border);
}
.cnt-badge.hot{background:var(--blocked-bg)}
.cnt-val{
  font-size:20px;font-weight:300;color:var(--bright);line-height:1;
  font-family:"JetBrains Mono",monospace;
}
.cnt-badge.hot .cnt-val{color:var(--blocked-text)}
.cnt-lbl{font-size:7px;color:var(--muted);font-weight:400;margin-top:4px;text-transform:uppercase;letter-spacing:.1em}
.entry-arrow{
  width:42px;flex-shrink:0;
  display:flex;align-items:center;justify-content:center;
  font-size:14px;color:var(--muted);
  border-left:1px solid var(--border);
  align-self:stretch;
  transition:color .15s;font-family:"JetBrains Mono",monospace;
}
.entry-card:hover .entry-arrow{color:var(--text)}

/* â”€â”€ PERSONAL FINANCE â”€â”€ */
.pfin-summary{
  display:flex;border-top:1px solid var(--border);background:var(--bg2);
}
.pfin-col{flex:1;padding:14px 16px;text-align:center;border-right:1px solid var(--border)}
.pfin-col:last-child{border-right:none}
.pfin-lbl{font-size:8px;color:var(--muted);letter-spacing:.12em;text-transform:uppercase;margin-bottom:5px}
.pfin-val{font-size:16px;font-weight:300;font-family:"JetBrains Mono",monospace}
.pfin-val.inc,.pfin-val.pos{color:var(--green)}
.pfin-val.exp,.pfin-val.neg{color:#8A4040}
.pfin-val.dim{color:var(--dim)}
.pfin-tx{padding:0 24px 12px}
.pfin-tx-row{
  display:flex;gap:10px;padding:8px 0;
  border-bottom:1px solid var(--border);font-size:11px;
  transition:background .12s;
}
.pfin-tx-row:last-child{border-bottom:none}
.pfin-tx-date{color:var(--muted);flex-shrink:0;min-width:44px;font-family:"JetBrains Mono",monospace;font-size:9px;font-weight:300}
.pfin-tx-item{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--text);font-weight:300}
.pfin-tx-amt{font-family:"JetBrains Mono",monospace;font-weight:400;flex-shrink:0}

/* â”€â”€ FOOTER â”€â”€ */
footer{
  text-align:center;padding:28px 32px;
  font-size:9px;color:var(--muted);
  border-top:1px solid var(--border);
  font-family:"JetBrains Mono",monospace;
  letter-spacing:.12em;text-transform:uppercase;
}

/* â”€â”€ PAGE FADE IN â”€â”€ */
@keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
main>section{animation:fadeUp .5s ease both}
main>section:nth-child(1){animation-delay:.06s}
main>section:nth-child(2){animation-delay:.14s}
main>section:nth-child(3){animation-delay:.22s}

/* â”€â”€ TABLET â”€â”€ */
@media(max-width:1024px){
  main{padding:40px 24px;gap:44px}
  .hdr-name{font-size:16px}
  .hdr-clock{font-size:13px}
  .a-chip{font-size:13px}
  .sec-lbl{font-size:11px}
  .wc-title{font-size:17px}
  .wc-meta{font-size:13px}
  .wc-next,.wc-blocked{font-size:14px}
  .tag{font-size:11px;padding:3px 9px}
  .brief-date{font-size:14px}
  .brief-line{font-size:16px;padding:14px 20px}
  .brief-block-hdr{padding:12px 20px 8px}
  .entry-name{font-size:17px}
  .entry-role{font-size:12px}
  .cnt-val{font-size:24px}
  .cnt-lbl{font-size:9px}
  .ov-ttl{max-width:none}
}
/* â”€â”€ PHONE â”€â”€ */
@media(max-width:640px){
  header{padding:0 20px}
  #info-bar,#alert-strip{padding:0 20px}
  main{padding:28px 18px;gap:36px}
  .entry-counts{display:none}
  .wc-title{font-size:17px}
  .tag{font-size:12px;padding:2px 8px}
  .brief-line{font-size:16px;padding:12px 18px}
  .brief-block-hdr{padding:10px 18px 6px}
  .entry-name{font-size:18px}
  .entry-icon-col{width:44px}
  .cnt-badge{padding:10px 10px}
  .hdr-clock{font-size:11px}
  .a-chip{font-size:13px}
  .a-lbl{font-size:11px}
}
</style>
</head>
<body>

<!-- HEADER -->
<header id="main-header">
  <div class="hdr-l">
    <div class="logo">
      <img src="assets/avatar.png" alt="OC" onerror="this.style.display='none';this.parentElement.textContent='â—ˆ'">
    </div>
    <div>
      <div class="hdr-name">Open Claw</div>
      <div class="hdr-sub">å…¨å„€è¡¨æ¿</div>
    </div>
  </div>
  <div id="clk" class="hdr-clock"></div>
</header>

<!-- INFO BAR -->
<div id="info-bar">
  <div class="ib-weather" id="ib-weather">â‹¯</div>
  <div class="ib-lunar" id="ib-lunar">è¾²æ›†è¼‰å…¥ä¸­</div>
</div>

<!-- ALERT STRIP -->
<div id="alert-strip">
  <span class="a-lbl" id="a-lbl">Alert</span>
  <span id="a-items" class="a-none">è¼‰å…¥ä¸­â€¦</span>
</div>

<main>

  <!-- ä»Šæ—¥æé†’ -->
  <section>
    <div class="sec-lbl">ä»Šæ—¥æé†’</div>
    <div id="brief-wrap" class="brief-wrap">
      <div class="brief-header"><span class="brief-date">è¼‰å…¥ä¸­â€¦</span></div>
    </div>
  </section>

  <!-- é‡é»è­¦ç¤º -->
  <section>
    <div class="sec-lbl">é‡é»è­¦ç¤º</div>
    <div class="warn-grid" id="warn-grid">
      <div class="warn-empty">è¼‰å…¥ä¸­â€¦</div>
    </div>
  </section>

  <!-- å…¨å€ç¸½è¦½ -->
  <section>
    <div class="sec-lbl">å…¨å€ç¸½è¦½</div>
    <div id="acc-wrap">
      <div style="padding:24px;font-size:11px;color:var(--muted);border:1px solid var(--border);border-radius:var(--radius)">è¼‰å…¥ä¸­â€¦</div>
    </div>
  </section>

</main>

<footer>Open Claw &nbsp;Â·&nbsp; æ¯æ—¥è‡ªå‹•æ›´æ–° &nbsp;Â·&nbsp; tasks.json</footer>

<script>
// â”€â”€ SCROLL: shrink header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function(){
  const hdr=document.getElementById("main-header");
  const info=document.getElementById("info-bar");
  const strip=document.getElementById("alert-strip");
  let t=false;
  window.addEventListener("scroll",()=>{
    if(!t){
      requestAnimationFrame(()=>{
        const s=window.scrollY>30;
        hdr.classList.toggle("scrolled",s);
        const hh=s?44:52;
        if(info) info.style.top=hh+"px";
        if(strip) strip.style.top=(hh+26)+"px";
        t=false;
      });
      t=true;
    }
  },{passive:true});
})();

const IC={
  caitodo:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>`,
  zhaojing:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="12" height="18"/><path d="M15 7h4l2 14H15"/><line x1="7" y1="8" x2="10" y2="8"/><line x1="7" y1="12" x2="10" y2="12"/><rect x="8" y="17" width="3" height="4"/></svg>`,
  finance:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 17 9 11 13 15 21 6"/><polyline points="17 6 21 6 21 10"/><line x1="3" y1="20" x2="21" y2="20"/></svg>`,
  personal:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="8" width="20" height="13" rx="2"/><path d="M6 8V6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v2"/><circle cx="16" cy="14.5" r="1.5" fill="white" stroke="none"/></svg>`,
  openclaw:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 9 8 12 4 15"/><line x1="12" y1="15" x2="19" y2="15"/><rect x="2" y="3" width="20" height="18" rx="2"/></svg>`,
};

const AREAS=[
  {key:"caitodo", name:"æ‰å¤šå¤š",    role:"ç§»å·¥ãƒ»åƒ‘å¤–ç”Ÿãƒ»æ´¾é£",icon:IC.caitodo, path:"caitodo/",  data:"data/caitodo/tasks.json"},
  {key:"zhaojing",name:"å…†é¯¨é¡§å•",  role:"é¡§å•ãƒ»ç‰©æ¥­ãƒ»é›»å•†",  icon:IC.zhaojing,path:"zhaojing/", data:"data/zhaojing/tasks.json"},
  {key:"finance", name:"ç†è²¡åˆ†æå¸«",role:"è‚¡ç¥¨ãƒ»å¸³å‹™ãƒ»KDJ",   icon:IC.finance, path:"finance/",  data:"data/finance/tasks.json"},
  {key:"personal",name:"å€‹äººè²¡å‹™",  role:"å¤§ç¸½ç®¡",            icon:IC.personal,path:"personal/", data:"data/personal/tasks.json"},
  {key:"openclaw",name:"OpenClaw",  role:"é–‹ç™¼å„ªåŒ–å¸«",        icon:IC.openclaw,path:"openclaw/", data:"data/openclaw/tasks.json"},
];
const DATA={};
let PFIN=null;
const PRI_LBL={urgent:"æ€¥ä»¶",important:"é‡è¦",normal:"ä¸€èˆ¬"};
const TYPE_LBL={remittance:"ğŸ’³ åŒ¯æ¬¾",alert:"ğŸ”” æé†’",task:"ä»»å‹™"};

function isWarn(t){return t.priority==="urgent"||t.type==="remittance"||t.status==="é˜»å¡";}
function isSched(t){return t.time&&t.time!=="-"&&t.freq&&t.freq!=="-";}
function chipCls(t){return t.type==="remittance"?"r":t.status==="é˜»å¡"?"b":"u";}
function chipIcon(t){
  if(t.type==="remittance") return `<svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>`;
  if(t.status==="é˜»å¡") return `<svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/></svg>`;
  return `<svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>`;
}
function fmtTs(iso){
  if(!iso||iso==="-") return "-";
  const d=new Date(iso);if(isNaN(d)) return iso;
  const now=new Date();
  if(d.toDateString()===now.toDateString())
    return d.toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit",hour12:false});
  return d.toLocaleDateString("zh-TW",{month:"2-digit",day:"2-digit"});
}
function counts(tasks){
  const c={pending:0,blocked:0,done:0};
  tasks.forEach(t=>{
    if(t.status==="å·²å®Œæˆ") c.done++;
    else if(t.status==="é˜»å¡") c.blocked++;
    else c.pending++;
  });
  return c;
}
function sortTasks(tasks){
  const pri={urgent:0,important:1,normal:2};
  return [...tasks].sort((a,b)=>{
    const ab=a.status==="é˜»å¡"?-1:0,bb=b.status==="é˜»å¡"?-1:0;
    if(ab!==bb) return ab-bb;
    return (pri[a.priority]??2)-(pri[b.priority]??2);
  });
}

// â”€â”€ ALERT STRIP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderStrip(){
  const strip=document.getElementById("alert-strip");
  const lbl=document.getElementById("a-lbl");
  const el=document.getElementById("a-items");
  const items=[];
  AREAS.forEach(area=>{(DATA[area.key]?.tasks||[]).filter(isWarn).forEach(t=>items.push({t,area}));});
  if(!items.length){
    strip.classList.remove("live");lbl.classList.remove("hot");
    lbl.textContent="Alert";el.className="a-none";
    el.textContent="ç›®å‰ç„¡æ€¥ä»¶ãƒ»ç„¡å¾…åŒ¯æ¬¾ãƒ»ç„¡é˜»å¡";return;
  }
  strip.classList.add("live");lbl.classList.add("hot");
  lbl.textContent=`Alert (${items.length})`;el.className="";
  el.innerHTML=items.map(({t,area},i)=>`
    ${i>0?'<span class="a-sep"></span>':''}
    <span class="a-chip ${chipCls(t)}">
      <span class="a-dot"></span>${chipIcon(t)} ${t.title}
      <span class="a-area">[${area.name}]</span>
    </span>`).join("");
}

// â”€â”€ WARNING CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderWarnings(){
  const grid=document.getElementById("warn-grid");
  const items=[];
  AREAS.forEach(area=>{(DATA[area.key]?.tasks||[]).filter(isWarn).forEach(t=>items.push({t,area}));});
  if(!items.length){
    grid.innerHTML='<div class="warn-empty">â€” ç›®å‰ç„¡æ€¥ä»¶ã€åŒ¯æ¬¾æˆ–é˜»å¡é …ç›® â€”</div>';return;
  }
  grid.innerHTML=items.map(({t,area})=>{
    const cls=t.type==="remittance"?"remittance":t.status==="é˜»å¡"?"blocked":"urgent";
    const remitWarn=t.type==="remittance"&&(!t.due||t.due==="-"||!t.owner_role||t.owner_role==="-")
      ?`<div class="wc-blocked">âš  åŒ¯æ¬¾ç¼ºå°‘ due / owner_role</div>`:"";
    return `
    <div class="warn-card ${cls}">
      <div class="wc-top">
        <div class="wc-title">${t.title}</div>
        <div class="wc-tags">
          <span class="tag tag-area">${area.name}</span>
          <span class="tag tag-pri ${t.priority||''}">${PRI_LBL[t.priority]||t.priority||"-"}</span>
          ${t.status==="é˜»å¡"?`<span class="tag tag-status blocked">é˜»å¡</span>`:""}
        </div>
      </div>
      <div class="wc-meta">
        <span><span class="wc-meta-lbl">è² è²¬äºº </span>${t.owner_role||"-"}</span>
        <span><span class="wc-meta-lbl">æˆªæ­¢ </span>${t.due&&t.due!=="-"?t.due:"-"}</span>
        <span><span class="wc-meta-lbl">æ›´æ–° </span>${fmtTs(t.updated_at)}</span>
      </div>
      ${t.blocked_reason&&t.blocked_reason!=="-"
        ?`<div class="wc-blocked">é˜»å¡ â€” ${t.blocked_reason}</div>`
        :t.next_step&&t.next_step!=="-"
          ?`<div class="wc-next">â†’ ${t.next_step}</div>`:""}
      ${remitWarn}
    </div>`;
  }).join("");
}

// â”€â”€ LUCKY COLORS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LUCKY=[
  [{name:"ç´…è‰²",hex:"#C0392B"},{name:"æ©™è‰²",hex:"#E67E22"}],  // é€±æ—¥
  [{name:"ç™½è‰²",hex:"#C8C8C6"},{name:"é‡‘è‰²",hex:"#D4AF37"}],  // é€±ä¸€
  [{name:"ç²‰ç´…",hex:"#D4608A"},{name:"ç™½è‰²",hex:"#C0C0BE"}],  // é€±äºŒ
  [{name:"é»‘è‰²",hex:"#606060"},{name:"è—è‰²",hex:"#4A7090"}],  // é€±ä¸‰
  [{name:"ç¶ è‰²",hex:"#3A8A58"},{name:"é’è‰²",hex:"#1A9080"}],  // é€±å››
  [{name:"é‡‘è‰²",hex:"#D4AF37"},{name:"ç™½è‰²",hex:"#C8C8C6"}],  // é€±äº”
  [{name:"é»ƒè‰²",hex:"#C8A830"},{name:"æ£•è‰²",hex:"#8A6A40"}],  // é€±å…­
];

// â”€â”€ DAILY BRIEF â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderBrief(){
  const wrap=document.getElementById("brief-wrap");
  const now=new Date();
  const days=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"];
  const dateStr=`${now.getFullYear()} / ${String(now.getMonth()+1).padStart(2,"0")} / ${String(now.getDate()).padStart(2,"0")} &nbsp;é€±${days[now.getDay()]}`;
  const isMonday=now.getDay()===1;
  const lc=LUCKY[now.getDay()];
  const luckHtml=`<div class="brief-luck"><span class="luck-lbl">è²¡ç¥é–‹é‹è‰²</span>${lc.map(c=>`<span class="luck-item"><span class="luck-dot" style="background:${c.hex}"></span>${c.name}</span>`).join("")}</div>`;

  // æ’ç¨‹
  const schedItems=[];
  AREAS.forEach(area=>{
    (DATA[area.key]?.tasks||[]).filter(t=>{
      if(isSched(t)&&t.status!=="å·²å®Œæˆ"){
        const freq=t.freq;
        if(freq==="daily") return true;
        if(freq==="weekly-mon"&&isMonday) return true;
        if(freq==="weekly") return true;
      }
      return false;
    }).forEach(t=>schedItems.push({t,area}));
  });
  schedItems.sort((a,b)=>a.t.time.localeCompare(b.t.time));

  // å·¥ä½œå¾…è¾¦
  const workItems=[];
  AREAS.forEach(area=>{
    (DATA[area.key]?.tasks||[]).filter(t=>!isSched(t)&&t.status!=="å·²å®Œæˆ")
      .forEach(t=>workItems.push({t,area}));
  });
  const sorted=[...workItems].sort((a,b)=>{
    const pri={urgent:0,important:1,normal:2};
    const ab=a.t.status==="é˜»å¡"?-1:0,bb=b.t.status==="é˜»å¡"?-1:0;
    if(ab!==bb) return ab-bb;
    return (pri[a.t.priority]??2)-(pri[b.t.priority]??2);
  });
  let top3=sorted.filter(({t})=>t.priority==="urgent"||t.priority==="important"||t.status==="é˜»å¡").slice(0,3);
  if(!top3.length) top3=sorted.slice(0,3);

  const schedBlock=schedItems.length?`
    <div class="brief-block">
      <div class="brief-block-hdr">æ—©ç­æ’ç¨‹</div>
      ${schedItems.map(({t,area})=>{
        const w=t.status==="é˜»å¡";
        return `<div class="brief-line">
          <span class="brief-time">${t.time}</span>
          <span class="brief-text">${t.title}<span class="b-area">[${area.name}]</span></span>
          <span class="sched-status ${w?"warn":"ok"}">${w?"éœ€é—œæ³¨":"æ­£å¸¸"}</span>
        </div>`;
      }).join("")}
    </div>`:"";

  const workBlock=`
    <div class="brief-block">
      <div class="brief-block-hdr">å·¥ä½œå¾…è¾¦ Top 3</div>
      ${top3.length?top3.map(({t,area})=>`
        <div class="brief-line">
          <span class="brief-time">${t.priority==="urgent"?"â—":t.priority==="important"?"â—‹":"Â·"}</span>
          <span class="brief-text">${t.title}
            <span class="b-area">[${area.name}]</span>
            ${t.status==="é˜»å¡"?`<span class="b-blk">é˜»å¡</span>`:""}
            ${t.due&&t.due!=="-"?`<span class="b-due">${t.due}</span>`:""}
          </span>
        </div>`).join(""):
        `<div class="brief-line"><span class="brief-text" style="color:var(--muted)">â€” æš«ç„¡å¾…è™•ç†äº‹é … â€”</span></div>`}
    </div>`;

  wrap.innerHTML=`
    <div class="brief-header">
      <span class="brief-date">${dateStr}</span>
      ${luckHtml}
    </div>
    <div class="brief-body">${schedBlock}${workBlock}</div>`;
}

// â”€â”€ ENTRY CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderEntryCards(){
  const wrap=document.getElementById("acc-wrap");
  wrap.className="entry-wrap";
  wrap.innerHTML=AREAS.map(area=>{
    const d=DATA[area.key];
    const tasks=d?.tasks||[];
    const c=counts(tasks);
    const hot=c.blocked>0;
    const updStr=d?.updated_at?fmtTs(d.updated_at):"-";
    return `
    <a class="entry-card${hot?" hot":""}" href="${area.path}index.html">
      <div class="entry-icon-col">${area.icon}</div>
      <div class="entry-info">
        <div class="entry-name">${area.name}</div>
        <div class="entry-role">${area.role}</div>
        <div class="entry-upd">æ›´æ–° ${updStr}</div>
      </div>
      <div class="entry-counts">
        ${hot?`<div class="cnt-badge hot"><div class="cnt-val">${c.blocked}</div><div class="cnt-lbl">é˜»å¡</div></div>`:""}
        <div class="cnt-badge"><div class="cnt-val">${c.pending}</div><div class="cnt-lbl">å¾…è™•ç†</div></div>
        <div class="cnt-badge"><div class="cnt-val">${c.done}</div><div class="cnt-lbl">å®Œæˆ</div></div>
      </div>
      <div class="entry-arrow">â€º</div>
    </a>`;
  }).join("");
}

// â”€â”€ FETCH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadArea(area){
  try{
    const r=await fetch(area.data+"?_="+Date.now());
    if(!r.ok) throw 0;
    return await r.json();
  }catch(e){return null;}
}
async function init(){
  const [results,finRes]=await Promise.all([
    Promise.all(AREAS.map(loadArea)),
    fetch("data/personal/finance.json?_="+Date.now()).then(r=>r.ok?r.json():null).catch(()=>null)
  ]);
  AREAS.forEach((a,i)=>{DATA[a.key]=results[i]||{updated_at:null,tasks:[]};});
  PFIN=finRes;
  renderStrip();
  renderWarnings();
  renderBrief();
  renderEntryCards();
}

// â”€â”€ LUNAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderLunar(){
  const el=document.getElementById("ib-lunar");if(!el)return;
  try{
    const lunarFmt=new Intl.DateTimeFormat("zh-TW-u-ca-chinese",{year:"numeric",month:"long",day:"numeric"});
    const raw=lunarFmt.format(new Date());
    const m=raw.match(/([ç”²ä¹™ä¸™ä¸æˆŠå·±åºšè¾›å£¬ç™¸][å­ä¸‘å¯…å¯è¾°å·³åˆæœªç”³é…‰æˆŒäº¥]å¹´.*)/);
    el.textContent=m?"è¾²æ›† "+m[1]:raw;
  }catch(e){el.textContent="";}
}

// â”€â”€ WEATHER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const WMO={
  0:{i:"â˜€",d:"æ™´"},1:{i:"ğŸŒ¤",d:"æ™´æ™‚å¤šé›²"},2:{i:"â›…",d:"å¤šé›²"},3:{i:"â˜",d:"é™°"},
  45:{i:"ğŸŒ«",d:"éœ§"},48:{i:"ğŸŒ«",d:"éœ§"},
  51:{i:"ğŸŒ¦",d:"æ¯›æ¯›é›¨"},61:{i:"ğŸŒ§",d:"å°é›¨"},63:{i:"ğŸŒ§",d:"ä¸­é›¨"},65:{i:"ğŸŒ§",d:"å¤§é›¨"},
  80:{i:"ğŸŒ¦",d:"é™£é›¨"},81:{i:"ğŸŒ§",d:"ä¸­é™£é›¨"},95:{i:"â›ˆ",d:"é›·é™£é›¨"}
};
async function fetchWeather(){
  const el=document.getElementById("ib-weather");if(!el)return;
  try{
    let lat=22.9999,lon=120.2269,city="å°å—";
    try{
      const c=JSON.parse(localStorage.getItem("oc_geo")||"null");
      if(c&&Date.now()-c.ts<43200000){lat=c.lat;lon=c.lon;city="";}
      else if(navigator.geolocation){
        await new Promise(res=>{
          navigator.geolocation.getCurrentPosition(p=>{
            lat=p.coords.latitude;lon=p.coords.longitude;city="";
            localStorage.setItem("oc_geo",JSON.stringify({lat,lon,ts:Date.now()}));res();
          },()=>res(),{timeout:5000});
        });
      }
    }catch(e){}
    const r=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weathercode&timezone=Asia/Taipei`);
    if(!r.ok)throw 0;
    const d=await r.json();
    const cur=d.current;const w=WMO[cur.weathercode]||{i:"ğŸŒ¡",d:""};
    el.innerHTML=`<span style="font-size:15px;color:#E8E8E6;filter:brightness(1.3)">${w.i}</span> <b>${Math.round(cur.temperature_2m)}Â°</b> <span style="color:var(--text)">${w.d}${city?" Â· "+city:""}</span>`;
  }catch(e){el.textContent="â€”";}
}

// â”€â”€ CLOCK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function tick(){
  const e=document.getElementById("clk");if(!e)return;
  const n=new Date();
  const days=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"];
  const d=`${String(n.getMonth()+1).padStart(2,"0")}/${String(n.getDate()).padStart(2,"0")} é€±${days[n.getDay()]}`;
  const t=n.toLocaleTimeString("zh-TW",{hour12:false,hour:"2-digit",minute:"2-digit",second:"2-digit"});
  e.innerHTML=`${t}<br>${d}`;
}
tick();setInterval(tick,1000);
renderLunar();
fetchWeather();
init();
</script>
</body>
</html>
